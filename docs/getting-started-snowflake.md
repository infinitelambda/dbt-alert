<!-- markdownlint-disable no-inline-html no-alt-text ul-indent code-block-style -->
# Getting Started with `dbt_alert` in Snowflake

It is recommended to check out the [Sending Email Notifications](https://docs.snowflake.com/en/user-guide/email-stored-procedures) in Snowflake.

TODO

## Usage

TODO: add dbt usage guide

## Production Readiness

## 1. Create a Snowflake User

We need an associated Snowflake User that holds the (Slack/MS Teams) Channel's email address.

Login to Snowflake using this new user's credential and get the email verification done!

Sample script for User creation:

```sql
use role securityadmin;
create or replace user user_email_alert with
  password='<hidden>'
  email = 'data_failure-hashingstringhere@sample.slack.com';
```

## 1. Create the Notification Integration object

Make sure that the Notification Integration object gets created manually first using the `ACCOUNTADMIN` role.

Its script will be generated by `engine/resource/dbt_alert__create_or_get_resource` macro:

```bash
dbt run-operation dbt_alert__create_or_get_resource --args '{create: true}'
```

<details>
  <summary>ðŸ‘‰ Sample generated script</summary>
  
```sql
use role accountadmin;

create or replace notification integration ni_dbt_alert__dbt_alert_test__dev
  type = email
  enabled = true
  allowed_recipients = ('data_platform_failure-aaaaiaoon65nkv4kzfyksapxdi@sweatybetty.slack.com')
  comment = "DEV Notification Integration object used for dbt_alert_test dbt project";
grant usage on integration ni_dbt_alert__dbt_alert_test__dev to role role_transform_prod;
```

</details>

## 2. Decide to execute the jobs

All jobs can be found under the `jobs/` directory.

Refers to the [Usage](#usage) section to find the dbt usage, and configure it.
